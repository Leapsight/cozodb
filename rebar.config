{erl_opts, [debug_info]}.

{deps, []}.

{plugins, [rebar3_cargo]}.

{cargo_opts, [
    {src_dir, "native/cozodb"}
]}.

{profiles, [
    {prod, [
        {deps, [
            recon,
            observer_cli
        ]},
        {relx, [
            {release, {cozodb, "0.1.0"}, [
                %% Erlang
                sasl,
                crypto,
                inets,
                tools,
                runtime_tools,
                cozodb
            ]},
            {extended_start_script, true},
            {mode, prod},
            {src_tests, true},
            {sys_config, "./config/sys.config"},
            {vm_args, "./config/vm.args"},
            {overlay, [
                {mkdir, "./data"}
            ]}
        ]}
    ]}
]}.

{provider_hooks, [
    {pre, [
        {compile, {cargo, build}}
    ]},
    {post, [
        {clean, {cargo, clean}}
        %% ,{eunit, {cargo, test}}
    ]}
]}.

{shell, [
    {config, "config/sys.config"},
    {apps, [cozodb]}
]}.
